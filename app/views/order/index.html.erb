<h2>Order History</h2>

<% if @orders.any? %>
  <% @orders.each do |order| %>
    <div style="border: 1px solid #ccc; padding: 15px; margin-bottom: 20px;">
      <h3>Order #<%= order.id %></h3>
      <p><strong>Date:</strong> <%= order.created_at.strftime("%B %d, %Y") %></p>
      <p><strong>Status:</strong> <%= order.status.titleize %></p>
      <p><strong>Items:</strong> <%= order.order_items.count %></p>
      <p><strong>Total:</strong> $<%= sprintf("%.2f", order.total_price / 100.0) %></p>
      <p><strong>Shipping to:</strong> <%= order.address.city %>, <%= order.address.province.code %></p>

      <p><strong>Items in order:</strong></p>
      <ul>
        <% order.order_items.limit(3).each do |item| %>
          <li><%= item.product.name %> (Ã—<%= item.quantity %>)</li>
        <% end %>
        <% if order.order_items.count > 3 %>
          <li>+ <%= order.order_items.count - 3 %> more item(s)</li>
        <% end %>
      </ul>

      <p><%= link_to "View Details", order_path(order) %></p>
    </div>
  <% end %>

  <div>
    <%= paginate @orders %>
  </div>
<% else %>
  <p>You haven't placed any orders yet.</p>
  <p><%= link_to "Start Shopping", products_path %></p>
<% end %>
